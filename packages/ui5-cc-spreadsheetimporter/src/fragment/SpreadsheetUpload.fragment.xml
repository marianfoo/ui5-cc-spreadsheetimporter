<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:spreadsheetdialog="cc.spreadsheetimporter.XXXnamespaceXXX.control" xmlns:upload="sap.m.upload">
  <spreadsheetdialog:SpreadsheetDialog contentWidth="{= ${device>/system/phone} ? '100%' : '40vw' }" contentHeight="350px" verticalScrolling="false">
    <spreadsheetdialog:customHeader>
      <OverflowToolbar>
        <Title text="{i18n>spreadsheetupload}" />
        <ToolbarSpacer />
        <Button press="showPreview" text="{i18n>showPreview}" icon="sap-icon://display" visible="{= !${info>/hidePreview}}" />
        <Button press="onTempDownload" text="{i18n>downloadTemplate}" icon="sap-icon://download-from-cloud" visible="{= !${info>/hideGenerateTemplateButton}}" />
        <Button press="onOpenOptionsDialog" text="{i18n>showOptionMenu}" visible="{= ${info>/showOptions}}">
          <layoutData>
            <OverflowToolbarLayoutData priority="AlwaysOverflow" />
          </layoutData>
        </Button>
      </OverflowToolbar>
    </spreadsheetdialog:customHeader>
    <spreadsheetdialog:content>
      <FlexBox direction="Column" height="100%" width="80%" alignItems="Stretch" justifyContent="Center" fitContainer="true" class="centered">
        <MessageStrip
          xmlns:core="sap.ui.core"
          core:require="{ formatMessage: 'sap/base/strings/formatMessage' }"
          visible="{= ${info>/dataRows} > 0}"
          text="{
        parts: [
          'i18n>dataRows',
          'info>/dataRows'
        ],
        formatter: 'formatMessage'
      }"
          type="Success"
          enableFormattedText="true"
          showIcon="true"
        >
          <layoutData>
            <FlexItemData growFactor="1" styleClass="centeredFlex" />
          </layoutData>
        </MessageStrip>
        <upload:UploadSet
          id="UploadSet"
          instantUpload="false"
          showIcons="true"
          uploadButtonInvisible="{= ${info>/dataRows} > 0}"
          terminationEnabled="true"
          fileType="xlsx,xls,csv,xlsm"
          mode="None"
          afterItemAdded="onFileUpload"
          afterItemRemoved="onFileRemoved"
          sameFilenameAllowed="true"
          noDataIllustrationType="NoColumnsSet"
        >
		</upload:UploadSet>
      </FlexBox>
    </spreadsheetdialog:content>
    <spreadsheetdialog:buttons>
      <Button text="{i18n>upload}" press="onUploadSet" type="Emphasized" enabled="{= ${info>/dataRows} > 0}" />
      <Button press="onCloseDialog" text="{i18n>close}" />
    </spreadsheetdialog:buttons>
  </spreadsheetdialog:SpreadsheetDialog>
</core:FragmentDefinition>
