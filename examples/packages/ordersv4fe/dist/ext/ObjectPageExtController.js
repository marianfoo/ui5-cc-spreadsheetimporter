sap.ui.define([],function(){"use strict";return{openExcelUploadDialog:async function(e){this._view.setBusyIndicatorDelay(0);this._view.setBusy(true);if(!this.excelUpload){this.excelUpload=await this._controller.getAppComponent().createComponent({usage:"excelUpload",async:true,componentData:{context:this,columns:["product_ID","quantity","title","price","validFrom","timestamp","date","time"],mandatoryFields:["product_ID","quantity"],excelFileName:"Test.xlsx"}});this.excelUpload.attachCheckBeforeRead(function(e){const t=e.getParameter("sheetData");let i=[{title:"Price to high (max 10.000)",counter:0}];for(const e of t){if(e.UnitPrice){if(e.UnitPrice>1e4){i[0].counter=i[0].counter+1}}}e.getSource().addToErrorsResults(i)},this);this.excelUpload.attachChangeBeforeCreate(function(e){let t=e.getParameter("payload");if(t.price){t.price=Number(t.price.toFixed(1))}e.getSource().setPayload(t)},this)}this.excelUpload.openExcelUploadDialog();this._view.setBusy(false)}}});
//# sourceMappingURL=ObjectPageExtController.js.map